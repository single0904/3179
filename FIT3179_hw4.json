{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": "Malaysia Covid-19 Cases per 1000 people",
    "width": 500,
    "height": 300,
    "data": {
        "url": "https://raw.githubusercontent.com/single0904/3179/main/malaysia_cases.csv"
    },
    "selection": {
        "state_highlight": {
            "type": "multi",
            "fields": ["state"],
            "bind": "legend"
        }
    },
    "encoding": {
        "y": {
            "field": "cases_new",
            "type": "quantitative",
            "scale": {"type": "log","zero": false},
            "axis" : {"minExtent": 30, "tickCount": 3 }
        },
        "x": {
            "field": "cases_recovered",
            "type": "quantitative",
            "scale": {"type": "log","zero": false},
            "axis" : {"minExtent": 30, "tickCount": 3 }
        }
    },
    "layer": [
        {
            "mark": {"type": "circle"},
            "encoding": {
                "size": {"field": "state", "type": "nominal"},
                "color": {"field": "state", "type": "nominal"},
                "tooltip": [
                    {"field": "state", "type": "nominal"},
                    {"field": "cases_new", "type": "quantitative", "format": ","},
                    {"field": "cases_recovered", "type": "quantitative", "format": ","},
                    {"field": "cases_active", "type": "quantitative", "format": ","}
                ],
                "opacity": {
                    "condition": {
                    "selection": "state_highlight",
                    "value": 0.6
                    },
                    "value": 0.2
                } 
            }
        },
        {
            "mark": {
            "type": "text",
            "align": "right",
            "baseline": "middle",
            "dx": -12,
            "fontSize": 11.5,
            "fontStyle": "italic"
            },
            "encoding": {
                "text": {"field": "state", "type": "nominal"},
                "color": {"value": "black"},
                "opacity": {
                "condition": {
                "test": "datum['state'] == 'Melaka' || datum['state'] == 'Negeri Sembilan' || datum['state'] == 'Pahang' || datum['state'] == 'Perak' || datum['state'] == 'Perlis' || datum['state'] == 'Pulau Pinang' || datum['state'] == 'Sabah' || datum['state'] == 'Sarawak' || datum['state'] == 'Selangor' || datum['state'] == 'Terengganu'",
                "value": 1
                },
                "value": 0
                },
                "tooltip": [
                    {"field": "state", "type": "nominal"},
                    {"field": "cases_new", "type": "quantitative", "format": ","},
                    {"field": "cases_recovered", "type": "quantitative", "format": ","},
                    {"field": "cases_active", "type": "quantitative", "format": ","}
                ] 
            }
        }      
    ]
}
    

    
    